#!/bin/bash

# dependencies /////////////////////////////////////////////////////////////////

if [[ -z $(command -v frobulator) ]]
then
	if [[ $(id -u -n) = "root" ]]
	then
		SUDO_HOME=/root

		USER="${SUDO_USER}"

		HOME=/home/"${USER}"
	fi

	if [[ -z $(command -v curl) ]]
	then
		yes | apt-get install curl
	fi

	if [ ! -d "${HOME}"/.local/bin ]
	then
		mkdir -p "${HOME}"/.local/bin
	fi

	curl -s -L get.frbltr.app > "${HOME}"/.local/bin/frobulator

	chmod +x "${HOME}"/.local/bin/frobulator
fi

. "${HOME}"/.local/bin/frobulator

# script ///////////////////////////////////////////////////////////////////////

script=$(basename -- "${BASH_SOURCE[0]}")

# version //////////////////////////////////////////////////////////////////////

version="08-13-2023"

# usage ////////////////////////////////////////////////////////////////////////
# special case markers /////////////////////////////////////////////////////////

marker_sep='//////'

marker_elp='...'
marker_idt='      '
marker_prc='%'
marker_spc=' '

# prompt management tool (pmt) /////////////////////////////////////////////////

# prompt management and standardizing with 80 charcters width:
# adds line folding with word detection for strings over 80 characters long

frobulator.pmt () {

	# initialize string return array

	prompt_string=()

	# define input arguments

	begin="${1}"
	end="${2}"

	# provide fallback for line character count

	if [ -z "${count}" ]
	then
		count=${terminal_columns}
	fi

	# set span width

	if [ ${#begin} -le "${count}" ]
	then
		span="--------------------------------------------------------------------------------"
	else
		span=""
	fi

	# set span character default:
	# cannot use '\' character as span //////////////////////////////// FIX ME #

	span_character="/"

	# prepare span for line marker usage:
	# [   ] --------------------------------------------------------------------------

	# span=${span::-6} //////////////////////////////////////////////// FIX ME #

	# 3 arguments - replace span character with argument 3

	if [ $# -eq 3 ]
	then
		span_character="${3}"
		span_character_length=${#span_character}

		# if span character length greater than 2:
		# compensate by dividing to achieve 80 characters total span

		if [ ${span_character_length} -ge 2 ]
		then
			count=$((${count} / ${span_character_length}))

			span_length=${count}
		fi
	fi

	span_length=${#span}

	# 2+ arguments:
	# append space to 'begin' value
	# prepend space to 'end' value

	if [ $# -ge 2 ]
	then
		begin="${begin} "
		end=" ${end}"
	fi

	# define parsing calculation lengths

	begin_length=${#begin}
	end_length=${#end}

	# 75+ characters per string:
	# fold string using word detection at limit
	# to prevent overstepping 80 characters overall limit
	# indent second line onward (6 spaces) to match line marker
	# detect newline character and indent onward (6 spaces) to match line marker

	margin=5

	fold=$(( "${count}" - "${margin}" ))

	if [ "${begin_length}" -ge "${fold}" ]
	then
		begin=$(echo "${begin}" | fold -s -w "${fold}" | sed -e '2,$'"s/^/${marker_idt}/g" | sed -e 's/ \\n /\\n\n      /g')
	fi

	# substitute span character

	span="${span//-/$span_character}"

	# print first argument:
	# remove newline for continuous string arguments

	span_begin=$(echo -n -e "${begin}")

	# print other arguments as fixed width prompt if present:
	# calculate span width - remove 6 characters for prompt header

	span_count=$(( ${span_length} - ${begin_length} - ${end_length} ))

	# set new padding width

 	if [ ${begin_length} -lt "${count}" ]
 	then
 		span=${span:0:$span_count}
 	else
 		span=""
 	fi

 	# define user input aor automatic fill

	span_middle="${span}"

	# print last argument:
	# carry newline and jump to next block

	span_end=$(echo -e "${end}")

	# populate array at end to avoid integrating spaces

	if [ $# -ge 0 ]
	then
		prompt_string=("${span_begin}""${span_middle}""${span_end}")
	fi

	if [ $# -eq 1 ]
	then
		prompt_string=("${span_begin}")
	fi

	if [ $# -ge 2 ]
	then
		prompt_string=("${span_begin}""${span_middle}""${span_end}")
	fi

	if [ $# -eq 3 ]
	then
		prompt_string=("${span_begin}""${span_middle}""${span_end}")
	fi

	# reset line elements

	unset begin
	unset end
	unset span
	unset count
}

# variables ////////////////////////////////////////////////////////////////////

frobulator.inf "Test line 1 - information"
frobulator.nul "Test line 2"
echo

frobulator.msg "Test line 1 - message"
frobulator.nul "Test line 2"
echo

frobulator.add "Test line 1 - add"
frobulator.nul "Test line 2"
echo

frobulator.rem "Test line 1 - remove"
frobulator.nul "Test line 2"
echo

frobulator.ret "Test line 1 - retain"
frobulator.nul "Test line 2"
echo

frobulator.rel "Test line 1 - release"
frobulator.nul "Test line 2"
echo

frobulator.fwd "Test line 1 - forward"
frobulator.nul "Test line 2"
echo

frobulator.rev "Test line 1 - reverse"
frobulator.nul "Test line 2"
echo

frobulator.stp "Test line 1 - stop"
frobulator.nul "Test line 2"
echo

frobulator.dwl "Test line 1 - download"
frobulator.nul "Test line 2"
echo

frobulator.upl "Test line 1 - upload"
frobulator.nul "Test line 2"
echo

frobulator.lnk "Test line 1 - link"
frobulator.nul "Test line 2"
echo

frobulator.scs "Test line 1 - success"
frobulator.nul "Test line 2"
echo

frobulator.wrn "Test line 1 - warning"
frobulator.nul "Test line 2"
echo

frobulator.err "Test line 1 - error"
frobulator.nul "Test line 2"
echo

frobulator.ins "Test line 1 - insert"
frobulator.nul "Test line 2"
echo

frobulator.ask "Test line 1 - question"
frobulator.nul "Test line 2"
echo

frobulator.ipt "Test line 1 - input"
frobulator.nul "Test line 2"
echo

frobulator.usr "Test line 1 - user"
frobulator.nul "Test line 2"
echo

frobulator.separate

frobulator.white "white"
frobulator.silver "silver"
frobulator.grey "grey"
frobulator.bla ck "bla ck"
echo

frobulator.red "red"
frobulator.crimson "crimson"
echo

frobulator.green "green"
frobulator.lime "lime"
echo

frobulator.yellow "yellow"
frobulator.orange "orange"
echo

frobulator.blue "blue"
frobulator.navy "navy"
echo

frobulator.magenta "magenta"
frobulator.purple "purple"
echo

frobulator.fuschia "fuschia"
frobulator.pink "pink"
echo

frobulator.aqua "aqua"
frobulator.teal "teal"
echo

frobulator.inf "test1" "[ test2 ]"

frobulator.inf "test1" "[ test2 ]" "+*+*"

frobulator.inf "test1" "[ test2 ]" z


frobulator.nul "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. At imperdiet dui accumsan sit. Est ante in nibh mauris cursus. Arcu vitae elementum curabitur vitae nunc sed velit. Aliquet sagittis id consectetur purus. Purus in mollis nunc sed id semper risus in hendrerit. Id cursus metus aliquam eleifend. Integer eget aliquet nibh praesent tristique magna sit. Pellentesque nec nam aliquam sem et tortor. Ipsum consequat nisl vel pretium lectus quam. Vitae congue mauris rhoncus aenean. Mauris pellentesque pulvinar pellentesque habitant morbi tristique. Turpis egestas sed tempus urna et pharetra pharetra. \n

Tempor nec feugiat nisl pretium fusce id velit. Diam maecenas sed enim ut sem viverra aliquet eget. Quis imperdiet massa tincidunt nunc. Fringilla ut morbi tincidunt augue interdum. Mauris commodo quis imperdiet massa tincidunt. Faucibus et molestie ac feugiat sed. A diam maecenas sed enim ut sem viverra. Sed risus ultricies tristique nulla aliquet enim tortor. Sollicitudin tempor id eu nisl nunc mi ipsum faucibus vitae. Ullamcorper malesuada proin libero nunc consequat interdum varius sit amet. In aliquam sem fringilla ut. Sit amet nulla facilisi morbi tempus. Felis imperdiet proin fermentum leo vel orci porta non. Mauris cursus mattis molestie a iaculis at erat.

Iaculis eu non diam phasellus vestibulum lorem sed risus. Diam quam nulla porttitor massa id neque aliquam vestibulum morbi. Facilisi cras fermentum odio eu feugiat pretium nibh ipsum. Odio ut enim blandit volutpat maecenas. Rutrum tellus pellentesque eu tincidunt tortor aliquam nulla facilisi cras. In est ante in nibh mauris cursus mattis molestie a. Morbi tristique senectus et netus et malesuada fames ac. Felis eget nunc lobortis mattis aliquam faucibus purus in massa. Pretium vulputate sapien nec sagittis aliquam malesuada bibendum arcu. Nunc mi ipsum faucibus vitae aliquet nec. Tortor consequat id porta nibh venenatis cras sed felis. Montes nascetur ridiculus mus mauris vitae. Sagittis id consectetur purus ut faucibus. Purus sit amet volutpat consequat mauris nunc congue nisi vitae. Facilisi cras fermentum odio eu feugiat pretium.

Est lorem ipsum dolor sit amet consectetur adipiscing. Duis convallis convallis tellus id interdum. Quis varius quam quisque id diam vel quam elementum. Tellus in hac habitasse platea dictumst vestibulum rhoncus est pellentesque. Suspendisse faucibus interdum posuere lorem. Elementum integer enim neque volutpat ac tincidunt vitae semper. Amet consectetur adipiscing elit ut. Proin sagittis nisl rhoncus mattis rhoncus urna neque viverra. Vestibulum sed arcu non odio euismod. Consectetur purus ut faucibus pulvinar elementum integer. Enim diam vulputate ut pharetra sit amet. Nam aliquam sem et tortor consequat id porta nibh venenatis. Dolor sed viverra ipsum nunc aliquet bibendum. Faucibus nisl tincidunt eget nullam non nisi. Sit amet cursus sit amet dictum sit amet justo donec. Suscipit adipiscing bibendum est ultricies. Quam lacus suspendisse faucibus interdum posuere. Interdum velit euismod in pellentesque massa placerat duis ultricies. Orci dapibus ultrices in iaculis nunc sed augue lacus viverra. Leo duis ut diam quam nulla porttitor massa id.

Mollis nunc sed id semper risus in hendrerit gravida rutrum. Vestibulum sed arcu non odio euismod lacinia at quis risus. Id diam vel quam elementum pulvinar. Diam phasellus vestibulum lorem sed risus. Sit amet risus nullam eget felis eget nunc lobortis mattis. Aenean vel elit scelerisque mauris pellentesque pulvinar pellentesque habitant morbi. Adipiscing tristique risus nec feugiat in fermentum posuere. Malesuada fames ac turpis egestas sed tempus urna et pharetra. Scelerisque eleifend donec pretium vulputate sapien nec. At erat pellentesque adipiscing commodo elit.

Sagittis orci a scelerisque purus semper. Sapien faucibus et molestie ac feugiat sed lectus vestibulum. Urna nec tincidunt praesent semper feugiat nibh sed pulvinar proin. Facilisi nullam vehicula ipsum a arcu cursus vitae. Sed sed risus pretium quam vulputate. Sodales ut etiam sit amet nisl. Cursus mattis molestie a iaculis at erat pellentesque adipiscing commodo. Amet consectetur adipiscing elit duis tristique sollicitudin. Facilisis volutpat est velit egestas dui. Vel risus commodo viverra maecenas. Scelerisque fermentum dui faucibus in ornare quam viverra orci sagittis.

Neque viverra justo nec ultrices dui sapien. Ornare arcu dui vivamus arcu. Rhoncus est pellentesque elit ullamcorper dignissim. Facilisis volutpat est velit egestas. Sapien pellentesque habitant morbi tristique senectus et. Massa enim nec dui nunc mattis enim ut. Fringilla ut morbi tincidunt augue interdum velit euismod in pellentesque. Dolor sit amet consectetur adipiscing elit. Et pharetra pharetra massa massa ultricies mi quis hendrerit. Feugiat vivamus at augue eget arcu. Quis auctor elit sed vulputate mi sit amet. Ac tortor dignissim convallis aenean et tortor at. Integer quis auctor elit sed vulputate mi sit amet mauris. Lacinia quis vel eros donec ac odio. Aliquam vestibulum morbi blandit cursus risus at ultrices. Cursus metus aliquam eleifend mi. Ullamcorper malesuada proin libero nunc.

Malesuada nunc vel risus commodo viverra. Ullamcorper velit sed ullamcorper morbi tincidunt ornare massa. Facilisi etiam dignissim diam quis. Enim ut tellus elementum sagittis. Ut pharetra sit amet aliquam. Placerat duis ultricies lacus sed turpis tincidunt id. Sagittis vitae et leo duis ut diam quam nulla porttitor. Enim praesent elementum facilisis leo vel fringilla est. Non nisi est sit amet facilisis magna etiam. Tempus egestas sed sed risus pretium. Mi ipsum faucibus vitae aliquet nec ullamcorper sit amet. Sit amet nisl suscipit adipiscing bibendum. Urna neque viverra justo nec ultrices. At auctor urna nunc id cursus metus aliquam eleifend mi. Praesent elementum facilisis leo vel fringilla est ullamcorper eget. Turpis cursus in hac habitasse.

Nibh cras pulvinar mattis nunc sed blandit libero volutpat. Ut venenatis tellus in metus vulputate. Tincidunt arcu non sodales neque. Sapien eget mi proin sed libero enim sed faucibus turpis. Nunc sed blandit libero volutpat. Lacus laoreet non curabitur gravida arcu. Ut tortor pretium viverra suspendisse potenti. Nibh cras pulvinar mattis nunc sed blandit libero volutpat sed. Quis hendrerit dolor magna eget est lorem ipsum dolor. Egestas quis ipsum suspendisse ultrices gravida dictum fusce. Nunc faucibus a pellentesque sit amet porttitor eget. Sed risus pretium quam vulputate. Suspendisse in est ante in nibh mauris.

Ipsum a arcu cursus vitae congue. Felis bibendum ut tristique et egestas quis ipsum. At augue eget arcu dictum varius duis at consectetur. Sit amet cursus sit amet dictum. Porttitor leo a diam sollicitudin. Dolor sed viverra ipsum nunc aliquet bibendum enim facilisis gravida. Augue mauris augue neque gravida in fermentum et sollicitudin ac. Ornare massa eget egestas purus viverra accumsan in. Eu lobortis elementum nibh tellus molestie nunc non. Vestibulum mattis ullamcorper velit sed ullamcorper morbi tincidunt ornare. Egestas integer eget aliquet nibh. Neque gravida in fermentum et sollicitudin ac orci. Nibh praesent tristique magna sit amet purus. Vitae tempus quam pellentesque nec nam aliquam sem. Elementum nibh tellus molestie nunc non blandit. Elementum curabitur vitae nunc sed velit. Amet nisl suscipit adipiscing bibendum est ultricies integer. Sed egestas egestas fringilla phasellus faucibus scelerisque eleifend donec pretium."
echo
